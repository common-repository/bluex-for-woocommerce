function handleMessagesFromWindow(){window.addEventListener("message",e=>{let a=getDOMElements();"pudo:select"===e.data.type&&handlePudoSelect(e,a)})}function getDOMElements(){return{inputState:document.getElementById("billing_state"),inputDir:document.getElementById("billing_address_1"),inputDir2:document.getElementById("billing_address_2"),countryContainer:document.getElementById("select2-billing_country-container"),stateContainer:document.querySelector("#select2-billing_state-container"),inputCity:document.getElementById("billing_city"),agencyIdInput:document.getElementById("agencyId")}}function handlePudoSelect(e,a){let t=e.data.payload;if(t&&t.location){let{street_name:n="",street_number:i="",city_name:r="",country_name:l="",state_name:o=""}=t.location;a.agencyIdInput.value=t.agency_id,a.inputDir.value=`${n} ${i}`,a.inputDir2.value=t.agency_name,a.countryContainer&&(a.countryContainer.value=l);let m=getStateDetails(o);a.stateContainer.innerHTML=m.fullName,a.inputState.value=m.abreviation,a.inputState.title=m.fullName,cityToInput(a.inputCity,r),triggerUpdateCheckout()}}function cityToInput(e,a){if("INPUT"===e.tagName){e.value=a;return}var t=e.getAttribute("name"),n=e.getAttribute("id"),i=e.getAttribute("placeholder"),r=e.parentNode.querySelector(".select2-container");r&&r.parentNode.removeChild(r);var l=document.createElement("input");l.type="text",l.className="input-text",l.name=t,l.id=n,l.placeholder=i,l.value=a,e.parentNode.replaceChild(l,e)}function triggerChangeEvent(e){let a=new Event("change",{bubbles:!0,cancelable:!0});e.dispatchEvent(a)}function getStateDetails(e){return[{abreviation:"CL-AI",fullName:"Ais\xe9n del General Carlos Iba\xf1ez del Campo",nameFromIframe:"Ays\xe9n"},{abreviation:"CL-AN",fullName:"Antofagasta",nameFromIframe:"Antofagasta"},{abreviation:"CL-AP",fullName:"Arica y Parinacota",nameFromIframe:"Arica y Parinacota"},{abreviation:"CL-AR",fullName:"La Araucan\xeda",nameFromIframe:"Araucan\xeda"},{abreviation:"CL-AT",fullName:"Atacama",nameFromIframe:"Atacama"},{abreviation:"CL-BI",fullName:"Biob\xedo",nameFromIframe:"B\xedo - B\xedo"},{abreviation:"CL-CO",fullName:"Coquimbo",nameFromIframe:"Coquimbo"},{abreviation:"CL-LI",fullName:"Libertador General Bernardo O'Higgins",nameFromIframe:"Libertador General Bernardo O`Higgins"},{abreviation:"CL-LL",fullName:"Los Lagos",nameFromIframe:"Los Lagos"},{abreviation:"CL-LR",fullName:"Los R\xedos",nameFromIframe:"Los R\xedos"},{abreviation:"CL-MA",fullName:"Magallanes",nameFromIframe:"Magallanes y la Antartica Chilena"},{abreviation:"CL-ML",fullName:"Maule",nameFromIframe:"Maule"},{abreviation:"CL-NB",fullName:"\xd1uble",nameFromIframe:"\xd1uble"},{abreviation:"CL-RM",fullName:"Regi\xf3n Metropolitana de Santiago",nameFromIframe:"Metropolitana de Santiago"},{abreviation:"CL-TA",fullName:"Tarapac\xe1",nameFromIframe:"Tarapac\xe1"},{abreviation:"CL-VS",fullName:"Valpara\xedso",nameFromIframe:"Valparaiso"},{abreviation:"",fullName:"",nameFromIframe:""},].find(a=>a.nameFromIframe===e)||{}}function selectShipping(e){let a=document.getElementById("isPudoSelected");if(a.value=e,"normalShipping"===e){let t=getDOMElements();clearElements(t),triggerChangeEvent(t.inputState)}clearWooCommerceShippingCache()}function clearElements(e){e.agencyIdInput.value="",e.inputDir.value="",e.inputDir2.value=""}function triggerUpdateCheckout(){let e=new CustomEvent("update_checkout");document.body.dispatchEvent(e)}function clearWooCommerceShippingCache(){let e=new XMLHttpRequest;e.open("POST","/wp-admin/admin-ajax.php",!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.onload=function(){200===e.status&&triggerUpdateCheckout()},e.send("action=clear_shipping_cache")}document.addEventListener("DOMContentLoaded",()=>{clearWooCommerceShippingCache(),handleMessagesFromWindow()});